!function(){function t(t,e,n){for(;;){var r=t.indexOf(n,e);if(-1==r)return null;if(t.charAt(r+1)!=n)return r;e=r+2}}function e(e){for(var n=[],r="",a=0;a<e.length;++a){a&&(r+="\n");for(var l=e[a],s=0;s<l.length;){var i,c=null;if("["==l.charAt(s)&&"["!=l.charAt(s+1)){o.lastIndex=s+1;var u=o.exec(l);c=u[0].replace(/&/g," ");var f=s+c.length+2,d=t(l,f,"]");if(null==d)throw new Error("Unterminated token at "+s+" in '"+l+"'"+c);i=l.slice(f,d),s=d+1}else{var d=t(l,s,"[");null==d&&(d=l.length),i=l.slice(s,d),s=d}i=i.replace(/\[\[|\]\]/g,function(t){return t.charAt(0)}),n.push({style:c,text:i}),r+=i}}return{tokens:n,plain:r}}function n(t){return t.replace("&","&amp;").replace("<","&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function r(t,e,r){for(var a=[],o=0;o<e.length;++o){var c=e[o].style;c&&c.indexOf(" ")&&(c=c.split(" ").sort().join(" ")),a.push({style:c,text:e[o].text})}var u=l(t,r),f="",d=s(a,u);if(null!=d&&(f+='<div class="mt-test mt-fail">',f+="<pre>"+n(t)+"</pre>",f+='<div class="cm-s-default">',f+="expected:",f+=i(a,d),f+="observed: [<a onclick=\"this.parentElement.className+=' mt-state-unhide'\">display states</a>]",f+=i(u,d),f+="</div>",f+="</div>"),u.indentFailures)for(var o=0;o<u.indentFailures.length;o++)f+="<div class='mt-test mt-fail'>"+n(u.indentFailures[o])+"</div>";if(f)throw new Failure(f)}function a(t){function e(t,e){if("function"==typeof e){var n=e.toString().match(/function\s*[^\s(]*/);return n?n[0]:"function"}return e}return window.JSON&&JSON.stringify?JSON.stringify(t,e,2):"[unsupported]"}function l(t,e){for(var n=e.startState(),r=t.replace(/\r\n/g,"\n").split("\n"),l=[],s=0,i=0;i<r.length;++i){var o=r[i],c=!0;if(e.indent){var u=o.match(/^\s*/)[0],f=e.indent(n,o.slice(u.length));f!=CodeMirror.Pass&&f!=u.length&&(l.indentFailures||(l.indentFailures=[])).push("Indentation of line "+(i+1)+" is "+f+" (expected "+u.length+")")}var d=new CodeMirror.StringStream(o);for(""==o&&e.blankLine&&e.blankLine(n);!d.eol();){for(var p=0;10>p&&d.start>=d.pos;p++)var v=e.token(d,n);if(10==p)throw new Failure("Failed to advance the stream."+d.string+" "+d.pos);var h=d.current();if(v&&v.indexOf(" ")>-1&&(v=v.split(" ").sort().join(" ")),d.start=d.pos,s&&l[s-1].style==v&&!c?l[s-1].text+=h:h&&(l[s++]={style:v,text:h,state:a(n)}),d.pos>5e3){l[s++]={style:null,text:this.text.slice(d.pos)};break}c=!1}}return l}function s(t,e){for(var n=Math.min(t.length,e.length),r=0;n>r;++r)if(t[r].style!=e[r].style||t[r].text!=e[r].text)return r;return t.length>n||e.length>n?n:void 0}function i(t,e){var r='<table class="mt-output">';r+="<tr>";for(var a=0;a<t.length;++a){var l=t[a].style,s=t[a].text;r+='<td class="mt-token"'+(a==2*e?" style='background: pink'":"")+'><span class="cm-'+n(String(l))+'">'+n(s.replace(/ /g,"Â·"))+"</span></td>"}r+="</tr><tr>";for(var a=0;a<t.length;++a)r+='<td class="mt-style"><span>'+(t[a].style||null)+"</span></td>";if(t[0].state){r+='</tr><tr class="mt-state-row" title="State AFTER each token">';for(var a=0;a<t.length;++a)r+='<td class="mt-state"><pre>'+n(t[a].state)+"</pre></td>"}return r+="</tr></table>"}var o=/[\w&-_]+/g;test.mode=function(t,n,a,l){var s=e(a);return test((l||n.name)+"_"+t,function(){return r(s.plain,s.tokens,n)})}}();